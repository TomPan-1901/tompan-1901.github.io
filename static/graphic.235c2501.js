var te=Object.defineProperty;var ie=(e,r,i)=>r in e?te(e,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[r]=i;var d=(e,r,i)=>(ie(e,typeof r!="symbol"?r+"":r,i),i);import{n as z,q as ne,r as j,s as ae,u as se,v as oe,o as le,c as he,b as ce,w as fe,a as k,x as g,d as me}from"./entry.076ed64c.js";var V=1e-6,K=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var e=0,r=arguments.length;r--;)e+=arguments[r]*arguments[r];return Math.sqrt(e)});function E(){var e=new K(16);return K!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function ue(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function q(e,r){if(e===r){var i=r[1],n=r[2],a=r[3],t=r[6],s=r[7],o=r[11];e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=i,e[6]=r[9],e[7]=r[13],e[8]=n,e[9]=t,e[11]=r[14],e[12]=a,e[13]=s,e[14]=o}else e[0]=r[0],e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=r[1],e[5]=r[5],e[6]=r[9],e[7]=r[13],e[8]=r[2],e[9]=r[6],e[10]=r[10],e[11]=r[14],e[12]=r[3],e[13]=r[7],e[14]=r[11],e[15]=r[15];return e}function H(e,r){var i=r[0],n=r[1],a=r[2],t=r[3],s=r[4],o=r[5],h=r[6],m=r[7],l=r[8],u=r[9],c=r[10],f=r[11],v=r[12],A=r[13],y=r[14],b=r[15],T=i*o-n*s,M=i*h-a*s,p=i*m-t*s,_=n*h-a*o,x=n*m-t*o,P=a*m-t*h,U=l*A-u*v,S=l*y-c*v,C=l*b-f*v,I=u*y-c*A,N=u*b-f*A,Y=c*b-f*y,w=T*Y-M*N+p*I+_*C-x*S+P*U;return w?(w=1/w,e[0]=(o*Y-h*N+m*I)*w,e[1]=(a*N-n*Y-t*I)*w,e[2]=(A*P-y*x+b*_)*w,e[3]=(c*x-u*P-f*_)*w,e[4]=(h*C-s*Y-m*S)*w,e[5]=(i*Y-a*C+t*S)*w,e[6]=(y*p-v*P-b*M)*w,e[7]=(l*P-c*p+f*M)*w,e[8]=(s*N-o*C+m*U)*w,e[9]=(n*C-i*N-t*U)*w,e[10]=(v*x-A*p+b*T)*w,e[11]=(u*p-l*x-f*T)*w,e[12]=(o*S-s*I-h*U)*w,e[13]=(i*I-n*S+a*U)*w,e[14]=(A*M-v*_-y*T)*w,e[15]=(l*_-u*M+c*T)*w,e):null}function G(e,r,i){var n=r[0],a=r[1],t=r[2],s=r[3],o=r[4],h=r[5],m=r[6],l=r[7],u=r[8],c=r[9],f=r[10],v=r[11],A=r[12],y=r[13],b=r[14],T=r[15],M=i[0],p=i[1],_=i[2],x=i[3];return e[0]=M*n+p*o+_*u+x*A,e[1]=M*a+p*h+_*c+x*y,e[2]=M*t+p*m+_*f+x*b,e[3]=M*s+p*l+_*v+x*T,M=i[4],p=i[5],_=i[6],x=i[7],e[4]=M*n+p*o+_*u+x*A,e[5]=M*a+p*h+_*c+x*y,e[6]=M*t+p*m+_*f+x*b,e[7]=M*s+p*l+_*v+x*T,M=i[8],p=i[9],_=i[10],x=i[11],e[8]=M*n+p*o+_*u+x*A,e[9]=M*a+p*h+_*c+x*y,e[10]=M*t+p*m+_*f+x*b,e[11]=M*s+p*l+_*v+x*T,M=i[12],p=i[13],_=i[14],x=i[15],e[12]=M*n+p*o+_*u+x*A,e[13]=M*a+p*h+_*c+x*y,e[14]=M*t+p*m+_*f+x*b,e[15]=M*s+p*l+_*v+x*T,e}function W(e,r,i){var n=i[0],a=i[1],t=i[2],s,o,h,m,l,u,c,f,v,A,y,b;return r===e?(e[12]=r[0]*n+r[4]*a+r[8]*t+r[12],e[13]=r[1]*n+r[5]*a+r[9]*t+r[13],e[14]=r[2]*n+r[6]*a+r[10]*t+r[14],e[15]=r[3]*n+r[7]*a+r[11]*t+r[15]):(s=r[0],o=r[1],h=r[2],m=r[3],l=r[4],u=r[5],c=r[6],f=r[7],v=r[8],A=r[9],y=r[10],b=r[11],e[0]=s,e[1]=o,e[2]=h,e[3]=m,e[4]=l,e[5]=u,e[6]=c,e[7]=f,e[8]=v,e[9]=A,e[10]=y,e[11]=b,e[12]=s*n+l*a+v*t+r[12],e[13]=o*n+u*a+A*t+r[13],e[14]=h*n+c*a+y*t+r[14],e[15]=m*n+f*a+b*t+r[15]),e}function de(e,r,i){var n=i[0],a=i[1],t=i[2];return e[0]=r[0]*n,e[1]=r[1]*n,e[2]=r[2]*n,e[3]=r[3]*n,e[4]=r[4]*a,e[5]=r[5]*a,e[6]=r[6]*a,e[7]=r[7]*a,e[8]=r[8]*t,e[9]=r[9]*t,e[10]=r[10]*t,e[11]=r[11]*t,e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function Me(e,r,i){var n=Math.sin(i),a=Math.cos(i),t=r[0],s=r[1],o=r[2],h=r[3],m=r[8],l=r[9],u=r[10],c=r[11];return r!==e&&(e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=t*a-m*n,e[1]=s*a-l*n,e[2]=o*a-u*n,e[3]=h*a-c*n,e[8]=t*n+m*a,e[9]=s*n+l*a,e[10]=o*n+u*a,e[11]=h*n+c*a,e}function ee(e,r){return e[0]=r[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=r[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function pe(e,r,i,n,a){var t=1/Math.tan(r/2),s;return e[0]=t/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,a!=null&&a!==1/0?(s=1/(n-a),e[10]=(a+n)*s,e[14]=2*a*n*s):(e[10]=-1,e[14]=-2*n),e}var _e=pe;function xe(e,r,i,n){var a,t,s,o,h,m,l,u,c,f,v=r[0],A=r[1],y=r[2],b=n[0],T=n[1],M=n[2],p=i[0],_=i[1],x=i[2];return Math.abs(v-p)<V&&Math.abs(A-_)<V&&Math.abs(y-x)<V?ue(e):(l=v-p,u=A-_,c=y-x,f=1/Math.hypot(l,u,c),l*=f,u*=f,c*=f,a=T*c-M*u,t=M*l-b*c,s=b*u-T*l,f=Math.hypot(a,t,s),f?(f=1/f,a*=f,t*=f,s*=f):(a=0,t=0,s=0),o=u*s-c*t,h=c*a-l*s,m=l*t-u*a,f=Math.hypot(o,h,m),f?(f=1/f,o*=f,h*=f,m*=f):(o=0,h=0,m=0),e[0]=a,e[1]=o,e[2]=l,e[3]=0,e[4]=t,e[5]=h,e[6]=u,e[7]=0,e[8]=s,e[9]=m,e[10]=c,e[11]=0,e[12]=-(a*v+t*A+s*y),e[13]=-(o*v+h*A+m*y),e[14]=-(l*v+u*A+c*y),e[15]=1,e)}function L(){var e=new K(3);return K!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function R(e,r,i){var n=new K(3);return n[0]=e,n[1]=r,n[2]=i,n}function F(e,r,i){return e[0]=r[0]+i[0],e[1]=r[1]+i[1],e[2]=r[2]+i[2],e}function B(e,r,i){return e[0]=r[0]*i,e[1]=r[1]*i,e[2]=r[2]*i,e}function D(e,r){var i=r[0],n=r[1],a=r[2],t=i*i+n*n+a*a;return t>0&&(t=1/Math.sqrt(t)),e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e}function J(e,r,i){var n=r[0],a=r[1],t=r[2],s=i[0],o=i[1],h=i[2];return e[0]=a*h-t*o,e[1]=t*s-n*h,e[2]=n*o-a*s,e}function ve(e,r,i,n){var a=[],t=[];return a[0]=r[0]-i[0],a[1]=r[1]-i[1],a[2]=r[2]-i[2],t[0]=a[2]*Math.sin(n)+a[0]*Math.cos(n),t[1]=a[1],t[2]=a[2]*Math.cos(n)-a[0]*Math.sin(n),e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e}(function(){var e=L();return function(r,i,n,a,t,s){var o,h;for(i||(i=3),n||(n=0),a?h=Math.min(a*i+n,r.length):h=r.length,o=n;o<h;o+=i)e[0]=r[o],e[1]=r[o+1],e[2]=r[o+2],t(e,e,s),r[o]=e[0],r[o+1]=e[1],r[o+2]=e[2];return r}})();function Q(e,r,i){const n=e.createShader(r);if(n===null)return console.error("unable to create shader"),null;if(e.shaderSource(n,i),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){const t=e.getShaderInfoLog(n);return console.error("Failed to compile shader: "+t),e.deleteShader(n),null}return n}function Ae(e,r,i){const n=Q(e,e.VERTEX_SHADER,r),a=Q(e,e.FRAGMENT_SHADER,i);if(!n||!a)return null;const t=e.createProgram();if(!t)return null;if(e.attachShader(t,n),e.attachShader(t,a),e.linkProgram(t),!e.getProgramParameter(t,e.LINK_STATUS)){const o=e.getProgramInfoLog(t);return console.error("Failed to link program: "+o),e.deleteProgram(t),e.deleteShader(a),e.deleteShader(n),null}return t}function Ee(e,r,i){const n=Ae(e,r,i);return n?(e.useProgram(n),e.program=n,!0):(console.error("Failed to create program"),!1)}function $(e,r,i){return G(E(),i,G(E(),r,e))}async function ye(){const r=(await z(()=>import("./teapot.2d9b4542.js"),[],import.meta.url)).default.split(`\r
`).filter(a=>a.length>0),i=parseInt(r[0]),n=new Float32Array(r.slice(1).map(a=>a.split(" ").map(parseFloat)).flat());return console.log(i),[n,i]}function O(e,r,i){const n=E(),a=R(Math.cos(r)*Math.cos(i),Math.sin(r),Math.cos(r)*Math.sin(i)),t=R(0,1,0);return D(a,a),xe(n,e,F(L(),e,a),t),n}function be(e,r){return R(Math.cos(e)*Math.cos(r),Math.sin(e),Math.cos(e)*Math.sin(r))}const X={ambient:[.19225,.19225,.19225,1],diffuse:[.50754,.50754,.50754,1],specular:[.508273,.508273,.508273,1],shininess:51.2};class Z{constructor(r,i=null){d(this,"children",[]);d(this,"modelMatrix",E());d(this,"absoluteModelMatrix",E());d(this,"gl");d(this,"parent");this.gl=r,this.parent=i}draw(r,i,n){G(this.absoluteModelMatrix,this.parent?this.parent.absoluteModelMatrix:E(),this.modelMatrix),this.children.forEach(a=>a.draw(r,i,n))}addChild(r){this.children.push(r)}}class re extends Z{constructor(i,n=null,a=!0){super(i,n);d(this,"vertices");d(this,"elements");d(this,"vertexBuffer");d(this,"elementsBuffer");d(this,"useLight",!0);this.absoluteModelMatrix=E(),this.modelMatrix=E(),this.useLight=a;const t=new Float32Array([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,-1,-1,1,1,-1,-1,1,-1,-1,-1,-1]),s=i.createBuffer(),o=new Uint8Array([0,1,2,0,2,3,0,3,4,0,4,5,0,5,6,0,6,1,1,6,7,1,7,2,7,4,3,7,3,2,4,7,6,4,6,5]),h=i.createBuffer();if(!s||!h)throw console.error("Failed to create buffer"),new Error("Failed to create buffer");i.bindBuffer(i.ARRAY_BUFFER,s),i.bufferData(i.ARRAY_BUFFER,t,i.STATIC_DRAW),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,h),i.bufferData(i.ELEMENT_ARRAY_BUFFER,o,i.STATIC_DRAW),this.vertices=t,this.elements=o,this.vertexBuffer=s,this.elementsBuffer=h}draw(i,n,a){super.draw(i,n,a),this.modelMatrix=Me(this.modelMatrix,this.modelMatrix,i);const t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.elementsBuffer);const s=this.vertices,o=t.getAttribLocation(t.program,"a_Position"),h=t.getAttribLocation(t.program,"a_Color"),m=t.getAttribLocation(t.program,"a_Normal"),l=t.getUniformLocation(t.program,"u_UseTexture"),u=t.getUniformLocation(t.program,"u_UseLight"),c=s.BYTES_PER_ELEMENT;t.vertexAttribPointer(o,3,t.FLOAT,!1,c*3,0),t.enableVertexAttribArray(o),t.vertexAttribPointer(m,3,t.FLOAT,!1,c*3,0),t.enableVertexAttribArray(m),t.vertexAttrib4f(h,1,1,1,1),t.uniform1i(l,0),t.uniform1i(u,this.useLight?1:0);const f=t.getUniformLocation(t.program,"u_MvpMatrix"),v=t.getUniformLocation(t.program,"u_NormalMatrix"),A=t.getUniformLocation(t.program,"u_ModelMatrix");let y=q(E(),H(E(),this.absoluteModelMatrix));t.uniformMatrix4fv(v,!1,y),t.uniformMatrix4fv(A,!1,this.absoluteModelMatrix);let b=$(this.absoluteModelMatrix,n,a);t.uniformMatrix4fv(f,!1,b),t.drawElements(t.TRIANGLES,36,t.UNSIGNED_BYTE,0),t.uniform1i(u,1),t.disableVertexAttribArray(m)}}class we extends Z{constructor(i,n=null){super(i,n);d(this,"vertextBuffer",null);d(this,"vertices",null);d(this,"lightPosition",R(-5,5,5));d(this,"lightCube");d(this,"loaded");this.modelMatrix=E(),this.children=[],this.modelMatrix=E(),this.absoluteModelMatrix=E(),this.lightCube=null,this.loaded=!1,ye().then(a=>{console.log(this),this.loaded=!0;const[t,s]=a,o=i.createBuffer();if(!o)throw console.error("Failed to create buffer"),new Error("Failed to create buffer");i.bindBuffer(i.ARRAY_BUFFER,o),i.bufferData(i.ARRAY_BUFFER,t,i.STATIC_DRAW),this.vertextBuffer=o,this.vertices=t;const h=i.getUniformLocation(i.program,"u_PositionalLight.position");i.uniform3fv(h,this.lightPosition);const m=i.getUniformLocation(i.program,"u_PositionalLight.color");i.uniform3f(m,1,1,1);const l=i.getUniformLocation(i.program,"u_PositionalLight.ambient");i.uniform4f(l,.2,.2,.2,1);const u=i.getUniformLocation(i.program,"u_PositionalLight.diffuse");i.uniform4f(u,1,1,1,1);const c=i.getUniformLocation(i.program,"u_PositionalLight.specular");i.uniform4f(c,1,1,1,1);const f=new re(i,this,!1);f.modelMatrix=W(E(),f.modelMatrix,this.lightPosition),f.modelMatrix=ee(E(),R(.1,.1,.1)),this.lightCube=f,this.addChild(f)})}draw(i,n,a){if(!this.loaded)return;this.lightPosition=ve(L(),this.lightPosition,R(0,this.lightPosition[1],0),i),W(this.lightCube.modelMatrix,E(),this.lightPosition),de(this.lightCube.modelMatrix,this.lightCube.modelMatrix,R(.1,.1,.1));const t=this.gl;super.draw(i,n,a);const s=t.getUniformLocation(t.program,"u_PositionalLight.position");t.uniform3fv(s,this.lightPosition),t.bindBuffer(t.ARRAY_BUFFER,this.vertextBuffer);const o=t.getUniformLocation(t.program,"u_Material.ambient");t.uniform4fv(o,X.ambient);const h=t.getUniformLocation(t.program,"u_Material.diffuse");t.uniform4fv(h,X.diffuse);const m=t.getUniformLocation(t.program,"u_Material.specular");t.uniform4fv(m,X.specular);const l=t.getUniformLocation(t.program,"u_Material.shininess");t.uniform1f(l,X.shininess);const u=this.vertices,c=t.getAttribLocation(t.program,"a_Position"),f=t.getAttribLocation(t.program,"a_Color"),v=t.getAttribLocation(t.program,"a_Normal"),A=u.BYTES_PER_ELEMENT;(c<0||f<0)&&console.error("Failed to get attribute location"),t.vertexAttrib4f(f,1,1,1,1),t.vertexAttribPointer(c,3,t.FLOAT,!1,6*A,0),t.enableVertexAttribArray(c),t.vertexAttribPointer(v,3,t.FLOAT,!1,6*A,3*A),t.enableVertexAttribArray(v);const y=t.getUniformLocation(t.program,"u_MvpMatrix");if(!y){console.error("Failed to get the storage location of u_MvpMatrix");return}const b=t.getUniformLocation(t.program,"u_LightColor"),T=t.getUniformLocation(t.program,"u_LightDirection"),M=t.getUniformLocation(t.program,"u_AmbientLight"),p=t.getUniformLocation(t.program,"u_NormalMatrix"),_=t.getUniformLocation(t.program,"u_ModelMatrix"),x=t.getUniformLocation(t.program,"u_UseTexture");t.uniform1i(x,0),t.uniform3f(b,1,1,1),t.uniform3fv(T,D(L(),[.5,3,4])),t.uniform3f(M,.2,.2,.2);let P=q(E(),H(E(),this.absoluteModelMatrix));t.uniformMatrix4fv(p,!1,P),t.uniformMatrix4fv(_,!1,this.absoluteModelMatrix);let U=$(this.absoluteModelMatrix,n,a);t.uniformMatrix4fv(y,!1,U),t.drawArrays(t.TRIANGLES,0,5144*3),t.disableVertexAttribArray(v)}}class Le extends Z{constructor(i,n=null){super(i,n);d(this,"vertexBuffer",null);d(this,"vertices",null);d(this,"elementBuffer",null);d(this,"texture",null);this.modelMatrix=E(),this.children=[],this.modelMatrix=E(),this.absoluteModelMatrix=E();let a=new Image;a.onload=()=>{this.texture=i.createTexture();const m=i.getUniformLocation(i.program,"u_Sampler");i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,this.texture),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,1),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.RGB,i.RGB,i.UNSIGNED_BYTE,a),i.uniform1i(m,0),console.log("load")},a.src="/brick.bmp";const t=new Float32Array([1,0,1,1,0,-1,0,1,0,0,-1,0,-1,0,1,1,0,-1,1,1]),s=new Uint8Array([0,1,2,0,2,3]),o=i.createBuffer(),h=i.createBuffer();if(!o)throw console.error("Failed to create buffer"),new Error("Failed to create buffer");i.bindBuffer(i.ARRAY_BUFFER,o),i.bufferData(i.ARRAY_BUFFER,t,i.STATIC_DRAW),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,h),i.bufferData(i.ELEMENT_ARRAY_BUFFER,s,i.STATIC_DRAW),this.vertexBuffer=o,this.vertices=t,this.elementBuffer=h}draw(i,n,a){super.draw(i,n,a);const t=this.gl;t.activeTexture(t.TEXTURE0),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.elementBuffer);const s=this.vertices,o=t.getAttribLocation(t.program,"a_Position"),h=t.getAttribLocation(t.program,"a_Color"),m=t.getAttribLocation(t.program,"a_Normal"),l=t.getAttribLocation(t.program,"a_TexCoord"),u=s.BYTES_PER_ELEMENT;(o<0||h<0)&&console.error("Failed to get attribute location"),t.vertexAttribPointer(o,3,t.FLOAT,!1,5*u,0),t.enableVertexAttribArray(o),t.vertexAttribPointer(l,2,t.FLOAT,!1,5*u,3*u),t.enableVertexAttribArray(l),t.vertexAttrib4f(h,1,1,1,1),t.vertexAttrib4f(m,0,1,0,0);const c=t.getUniformLocation(t.program,"u_MvpMatrix"),f=t.getUniformLocation(t.program,"u_NormalMatrix"),v=t.getUniformLocation(t.program,"u_ModelMatrix"),A=t.getUniformLocation(t.program,"u_UseTexture");t.uniform1i(A,1);let y=q(E(),H(E(),this.absoluteModelMatrix));t.uniformMatrix4fv(f,!1,y),t.uniformMatrix4fv(v,!1,this.absoluteModelMatrix);let b=$(this.absoluteModelMatrix,n,a);t.uniformMatrix4fv(c,!1,b),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_BYTE,0)}}class Te{constructor(r,i,n){d(this,"gl");d(this,"viewMatrix");d(this,"modelMatrix");d(this,"projectionMatrix");d(this,"eye");d(this,"up");d(this,"pitch",0);d(this,"yaw",-Math.PI/2);d(this,"mouseX");d(this,"mouseY");d(this,"drag",!1);d(this,"currentKeyDown");d(this,"skybox");d(this,"skyboxProgram");d(this,"teapot");if(this.gl=r,r.enable(r.DEPTH_TEST),this.skybox=null,!Ee(r,i,n))throw new Error("Failed to initialize shaders");const a=r.program;this.skyboxProgram=r.program,r.program=a,r.useProgram(a),this.viewMatrix=E(),this.modelMatrix=E(),this.projectionMatrix=E(),this.eye=R(0,5,5),this.teapot=new we(r);const t=new re(r,this.teapot),s=new Le(r,this.teapot);t.modelMatrix=W(E(),E(),R(0,2.5,-10)),s.modelMatrix=ee(E(),R(10,10,10)),this.teapot.addChild(s),this.teapot.addChild(t),this.currentKeyDown={ArrowUp:!1,ArrowDown:!1,ArrowLeft:!1,ArrowRight:!1,w:!1,s:!1,a:!1,d:!1,q:!1,e:!1},this.viewMatrix=O(this.eye,this.pitch,this.yaw),this.up=R(0,1,0),_e(this.projectionMatrix,Math.PI/2,1024/768,1,100)}draw(r){this.updateCamera(r);const i=this.gl;i.clearColor(0,0,0,1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),this.teapot.draw(r,this.viewMatrix,this.projectionMatrix)}handleKeydown(r){r.key in this.currentKeyDown&&(this.currentKeyDown[r.key]=!0)}handleMousemove(r){if(!this.drag)return;if(!this.mouseX||!this.mouseY){this.mouseX=r.clientX,this.mouseY=r.clientY;return}const i=(r.clientX-this.mouseX)/-1e3,n=(r.clientY-this.mouseY)/1e3;this.pitch+=n*2,this.pitch=Math.max(Math.min(this.pitch,Math.PI/2-.01),-Math.PI/2+.01),this.yaw+=i*2,this.yaw=this.yaw%(Math.PI*2),this.viewMatrix=O(this.eye,this.pitch,this.yaw),this.mouseX=r.clientX,this.mouseY=r.clientY}handleMouseup(r){this.mouseX=void 0,this.mouseY=void 0,this.drag=!1}handleMousedown(r){this.drag=!0}handleKeyup(r){r.key in this.currentKeyDown&&(this.currentKeyDown[r.key]=!1)}updateCamera(r){const i=be(this.pitch,this.yaw);if(this.currentKeyDown.ArrowUp)this.pitch+=r,this.pitch=Math.max(Math.min(this.pitch,Math.PI/2-.01),-Math.PI/2+.01);else if(this.currentKeyDown.ArrowDown)this.pitch-=r,this.pitch=Math.max(Math.min(this.pitch,Math.PI/2-.01),-Math.PI/2+.01);else if(this.currentKeyDown.ArrowLeft)this.yaw-=r,this.yaw=this.yaw%(Math.PI*2);else if(this.currentKeyDown.ArrowRight)this.yaw+=r,this.yaw=this.yaw%(Math.PI*2);else if(this.currentKeyDown.w)F(this.eye,this.eye,B(L(),D(L(),R(i[0],0,i[2])),r*4));else if(this.currentKeyDown.s)F(this.eye,this.eye,B(L(),D(L(),R(i[0],0,i[2])),-r*4));else if(this.currentKeyDown.a){const n=D(L(),J(L(),i,this.up));F(this.eye,this.eye,B(L(),n,-r*4))}else if(this.currentKeyDown.d){const n=D(L(),J(L(),i,this.up));F(this.eye,this.eye,B(L(),n,r*4))}else this.currentKeyDown.q?F(this.eye,this.eye,B(L(),this.up,-r*4)):this.currentKeyDown.e&&F(this.eye,this.eye,B(L(),this.up,r*4));this.viewMatrix=O(this.eye,this.pitch,this.yaw)}}const Re={class:"h-screen w-full flex overflow-auto relative"},ge={class:"m-auto"},Pe={class:"relative"},Be=ne({__name:"graphic",setup(e){const r=j(null),i=j(null);let n=0,a=null,t=null,s=null,o=null;function h(){const m=performance.now()/1e3,l=m-n;n=m,o.fillStyle="white",o.clearRect(0,0,400,100),o.font="50px serif",o.fillText(`FPS: ${Math.round(1/l)}`,50,90),s.draw(l),a=requestAnimationFrame(h)}return ae(async()=>{t=r.value.getContext("webgl"),o=i.value.getContext("2d");const m=(await z(()=>import("./vshader.f049359e.js"),[],import.meta.url)).default,l=(await z(()=>import("./fshader.4320ede6.js"),[],import.meta.url)).default;console.log(m,l),s=new Te(t,m,l),n=performance.now()/1e3,document.title="WebGL",h()}),se(()=>{a&&cancelAnimationFrame(a)}),(m,l)=>{const u=oe("RouterLink");return le(),he("div",Re,[ce(u,{to:"/",class:"absolute top-0 left-0 px-3 py-1 bg-cyan-400 rounded-full hover:bg-cyan-600 text-white"},{default:fe(()=>[me("Home")]),_:1}),k("div",ge,[k("div",Pe,[k("canvas",{tabindex:"0",class:"outline-none relative z-0 top-0 left-0",ref_key:"c",ref:r,width:"1024",height:"768",onKeydownCapture:l[0]||(l[0]=(...c)=>g(s).handleKeydown&&g(s).handleKeydown(...c)),onMousemoveCapture:l[1]||(l[1]=(...c)=>g(s).handleMousemove&&g(s).handleMousemove(...c)),onMousedown:l[2]||(l[2]=(...c)=>g(s).handleMousedown&&g(s).handleMousedown(...c)),onMouseup:l[3]||(l[3]=(...c)=>g(s).handleMouseup&&g(s).handleMouseup(...c)),onKeyupCapture:l[4]||(l[4]=(...c)=>g(s).handleKeyup&&g(s).handleKeyup(...c))},null,544),k("canvas",{class:"absolute z-10 top-0 left-0",width:"400",height:"100",ref_key:"hud",ref:i},null,512)])])])}}});export{Be as default};
