var ne=Object.defineProperty;var se=(e,r,t)=>r in e?ne(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var M=(e,r,t)=>(se(e,typeof r!="symbol"?r+"":r,t),t);import{C as W,D as oe,r as z,E as le,i as he,o as ce,c as fe,b as J,w as Q,d as ee,a as X,z as me,F as ue,l as g}from"./entry.29750580.js";import{T as de}from"./components.3627f3c5.js";import{_ as Me}from"./nuxt-link.7ac3df0d.js";import"./vue.f36acd1f.13d36f2f.js";var O=1e-6,K=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var e=0,r=arguments.length;r--;)e+=arguments[r]*arguments[r];return Math.sqrt(e)});function A(){var e=new K(16);return K!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function _e(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function H(e,r){if(e===r){var t=r[1],a=r[2],n=r[3],i=r[6],s=r[7],o=r[11];e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=t,e[6]=r[9],e[7]=r[13],e[8]=a,e[9]=i,e[11]=r[14],e[12]=n,e[13]=s,e[14]=o}else e[0]=r[0],e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=r[1],e[5]=r[5],e[6]=r[9],e[7]=r[13],e[8]=r[2],e[9]=r[6],e[10]=r[10],e[11]=r[14],e[12]=r[3],e[13]=r[7],e[14]=r[11],e[15]=r[15];return e}function $(e,r){var t=r[0],a=r[1],n=r[2],i=r[3],s=r[4],o=r[5],h=r[6],d=r[7],f=r[8],l=r[9],m=r[10],c=r[11],u=r[12],E=r[13],y=r[14],b=r[15],L=t*o-a*s,_=t*h-n*s,p=t*d-i*s,x=a*h-n*o,v=a*d-i*o,P=n*d-i*h,U=f*E-l*u,S=f*y-m*u,C=f*b-c*u,I=l*y-m*E,N=l*b-c*E,Y=m*b-c*y,w=L*Y-_*N+p*I+x*C-v*S+P*U;return w?(w=1/w,e[0]=(o*Y-h*N+d*I)*w,e[1]=(n*N-a*Y-i*I)*w,e[2]=(E*P-y*v+b*x)*w,e[3]=(m*v-l*P-c*x)*w,e[4]=(h*C-s*Y-d*S)*w,e[5]=(t*Y-n*C+i*S)*w,e[6]=(y*p-u*P-b*_)*w,e[7]=(f*P-m*p+c*_)*w,e[8]=(s*N-o*C+d*U)*w,e[9]=(a*C-t*N-i*U)*w,e[10]=(u*v-E*p+b*L)*w,e[11]=(l*p-f*v-c*L)*w,e[12]=(o*S-s*I-h*U)*w,e[13]=(t*I-a*S+n*U)*w,e[14]=(E*_-u*x-y*L)*w,e[15]=(f*x-l*_+m*L)*w,e):null}function V(e,r,t){var a=r[0],n=r[1],i=r[2],s=r[3],o=r[4],h=r[5],d=r[6],f=r[7],l=r[8],m=r[9],c=r[10],u=r[11],E=r[12],y=r[13],b=r[14],L=r[15],_=t[0],p=t[1],x=t[2],v=t[3];return e[0]=_*a+p*o+x*l+v*E,e[1]=_*n+p*h+x*m+v*y,e[2]=_*i+p*d+x*c+v*b,e[3]=_*s+p*f+x*u+v*L,_=t[4],p=t[5],x=t[6],v=t[7],e[4]=_*a+p*o+x*l+v*E,e[5]=_*n+p*h+x*m+v*y,e[6]=_*i+p*d+x*c+v*b,e[7]=_*s+p*f+x*u+v*L,_=t[8],p=t[9],x=t[10],v=t[11],e[8]=_*a+p*o+x*l+v*E,e[9]=_*n+p*h+x*m+v*y,e[10]=_*i+p*d+x*c+v*b,e[11]=_*s+p*f+x*u+v*L,_=t[12],p=t[13],x=t[14],v=t[15],e[12]=_*a+p*o+x*l+v*E,e[13]=_*n+p*h+x*m+v*y,e[14]=_*i+p*d+x*c+v*b,e[15]=_*s+p*f+x*u+v*L,e}function q(e,r,t){var a=t[0],n=t[1],i=t[2],s,o,h,d,f,l,m,c,u,E,y,b;return r===e?(e[12]=r[0]*a+r[4]*n+r[8]*i+r[12],e[13]=r[1]*a+r[5]*n+r[9]*i+r[13],e[14]=r[2]*a+r[6]*n+r[10]*i+r[14],e[15]=r[3]*a+r[7]*n+r[11]*i+r[15]):(s=r[0],o=r[1],h=r[2],d=r[3],f=r[4],l=r[5],m=r[6],c=r[7],u=r[8],E=r[9],y=r[10],b=r[11],e[0]=s,e[1]=o,e[2]=h,e[3]=d,e[4]=f,e[5]=l,e[6]=m,e[7]=c,e[8]=u,e[9]=E,e[10]=y,e[11]=b,e[12]=s*a+f*n+u*i+r[12],e[13]=o*a+l*n+E*i+r[13],e[14]=h*a+m*n+y*i+r[14],e[15]=d*a+c*n+b*i+r[15]),e}function pe(e,r,t){var a=t[0],n=t[1],i=t[2];return e[0]=r[0]*a,e[1]=r[1]*a,e[2]=r[2]*a,e[3]=r[3]*a,e[4]=r[4]*n,e[5]=r[5]*n,e[6]=r[6]*n,e[7]=r[7]*n,e[8]=r[8]*i,e[9]=r[9]*i,e[10]=r[10]*i,e[11]=r[11]*i,e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function xe(e,r,t){var a=Math.sin(t),n=Math.cos(t),i=r[0],s=r[1],o=r[2],h=r[3],d=r[8],f=r[9],l=r[10],m=r[11];return r!==e&&(e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=i*n-d*a,e[1]=s*n-f*a,e[2]=o*n-l*a,e[3]=h*n-m*a,e[8]=i*a+d*n,e[9]=s*a+f*n,e[10]=o*a+l*n,e[11]=h*a+m*n,e}function ie(e,r){return e[0]=r[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=r[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ve(e,r,t,a,n){var i=1/Math.tan(r/2),s;return e[0]=i/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,n!=null&&n!==1/0?(s=1/(a-n),e[10]=(n+a)*s,e[14]=2*n*a*s):(e[10]=-1,e[14]=-2*a),e}var Ae=ve;function Ee(e,r,t,a){var n,i,s,o,h,d,f,l,m,c,u=r[0],E=r[1],y=r[2],b=a[0],L=a[1],_=a[2],p=t[0],x=t[1],v=t[2];return Math.abs(u-p)<O&&Math.abs(E-x)<O&&Math.abs(y-v)<O?_e(e):(f=u-p,l=E-x,m=y-v,c=1/Math.hypot(f,l,m),f*=c,l*=c,m*=c,n=L*m-_*l,i=_*f-b*m,s=b*l-L*f,c=Math.hypot(n,i,s),c?(c=1/c,n*=c,i*=c,s*=c):(n=0,i=0,s=0),o=l*s-m*i,h=m*n-f*s,d=f*i-l*n,c=Math.hypot(o,h,d),c?(c=1/c,o*=c,h*=c,d*=c):(o=0,h=0,d=0),e[0]=n,e[1]=o,e[2]=f,e[3]=0,e[4]=i,e[5]=h,e[6]=l,e[7]=0,e[8]=s,e[9]=d,e[10]=m,e[11]=0,e[12]=-(n*u+i*E+s*y),e[13]=-(o*u+h*E+d*y),e[14]=-(f*u+l*E+m*y),e[15]=1,e)}function T(){var e=new K(3);return K!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function R(e,r,t){var a=new K(3);return a[0]=e,a[1]=r,a[2]=t,a}function F(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e}function B(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e}function D(e,r){var t=r[0],a=r[1],n=r[2],i=t*t+a*a+n*n;return i>0&&(i=1/Math.sqrt(i)),e[0]=r[0]*i,e[1]=r[1]*i,e[2]=r[2]*i,e}function re(e,r,t){var a=r[0],n=r[1],i=r[2],s=t[0],o=t[1],h=t[2];return e[0]=n*h-i*o,e[1]=i*s-a*h,e[2]=a*o-n*s,e}function ye(e,r,t,a){var n=[],i=[];return n[0]=r[0]-t[0],n[1]=r[1]-t[1],n[2]=r[2]-t[2],i[0]=n[2]*Math.sin(a)+n[0]*Math.cos(a),i[1]=n[1],i[2]=n[2]*Math.cos(a)-n[0]*Math.sin(a),e[0]=i[0]+t[0],e[1]=i[1]+t[1],e[2]=i[2]+t[2],e}(function(){var e=T();return function(r,t,a,n,i,s){var o,h;for(t||(t=3),a||(a=0),n?h=Math.min(n*t+a,r.length):h=r.length,o=a;o<h;o+=t)e[0]=r[o],e[1]=r[o+1],e[2]=r[o+2],i(e,e,s),r[o]=e[0],r[o+1]=e[1],r[o+2]=e[2];return r}})();function te(e,r,t){const a=e.createShader(r);if(a===null)return console.error("unable to create shader"),null;if(e.shaderSource(a,t),e.compileShader(a),!e.getShaderParameter(a,e.COMPILE_STATUS)){const i=e.getShaderInfoLog(a);return console.error("Failed to compile shader: "+i),e.deleteShader(a),null}return a}function be(e,r,t){const a=te(e,e.VERTEX_SHADER,r),n=te(e,e.FRAGMENT_SHADER,t);if(!a||!n)return null;const i=e.createProgram();if(!i)return null;if(e.attachShader(i,a),e.attachShader(i,n),e.linkProgram(i),!e.getProgramParameter(i,e.LINK_STATUS)){const o=e.getProgramInfoLog(i);return console.error("Failed to link program: "+o),e.deleteProgram(i),e.deleteShader(n),e.deleteShader(a),null}return i}function we(e,r,t){const a=be(e,r,t);return a?(e.useProgram(a),e.program=a,!0):(console.error("Failed to create program"),!1)}function Z(e,r,t){return V(A(),t,V(A(),r,e))}async function Le(){const r=(await W(()=>import("./teapot.2d9b4542.js"),[],import.meta.url)).default.split(`\r
`).filter(n=>n.length>0),t=parseInt(r[0]),a=new Float32Array(r.slice(1).map(n=>n.split(" ").map(parseFloat)).flat());return console.log(t),[a,t]}function G(e,r,t){const a=A(),n=R(Math.cos(r)*Math.cos(t),Math.sin(r),Math.cos(r)*Math.sin(t)),i=R(0,1,0);return D(n,n),Ee(a,e,F(T(),e,n),i),a}function Te(e,r){return R(Math.cos(e)*Math.cos(r),Math.sin(e),Math.cos(e)*Math.sin(r))}const k={ambient:[.19225,.19225,.19225,1],diffuse:[.50754,.50754,.50754,1],specular:[.508273,.508273,.508273,1],shininess:51.2};class j{constructor(r,t=null){M(this,"children",[]);M(this,"modelMatrix",A());M(this,"absoluteModelMatrix",A());M(this,"gl");M(this,"parent");this.gl=r,this.parent=t}draw(r,t,a){V(this.absoluteModelMatrix,this.parent?this.parent.absoluteModelMatrix:A(),this.modelMatrix),this.children.forEach(n=>n.draw(r,t,a))}addChild(r){this.children.push(r)}}class ae extends j{constructor(t,a=null,n=!0){super(t,a);M(this,"vertices");M(this,"elements");M(this,"vertexBuffer");M(this,"elementsBuffer");M(this,"useLight",!0);this.absoluteModelMatrix=A(),this.modelMatrix=A(),this.useLight=n;const i=new Float32Array([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,-1,-1,1,1,-1,-1,1,-1,-1,-1,-1]),s=t.createBuffer(),o=new Uint8Array([0,1,2,0,2,3,0,3,4,0,4,5,0,5,6,0,6,1,1,6,7,1,7,2,7,4,3,7,3,2,4,7,6,4,6,5]),h=t.createBuffer();if(!s||!h)throw console.error("Failed to create buffer"),new Error("Failed to create buffer");t.bindBuffer(t.ARRAY_BUFFER,s),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,h),t.bufferData(t.ELEMENT_ARRAY_BUFFER,o,t.STATIC_DRAW),this.vertices=i,this.elements=o,this.vertexBuffer=s,this.elementsBuffer=h}draw(t,a,n){super.draw(t,a,n);let i=xe(A(),this.parent.modelMatrix,t*.5);V(this.modelMatrix,i,this.modelMatrix);const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,this.vertexBuffer),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,this.elementsBuffer);const o=this.vertices,h=s.getAttribLocation(s.program,"a_Position"),d=s.getAttribLocation(s.program,"a_Color"),f=s.getAttribLocation(s.program,"a_Normal"),l=s.getUniformLocation(s.program,"u_UseTexture"),m=s.getUniformLocation(s.program,"u_UseLight"),c=o.BYTES_PER_ELEMENT;s.vertexAttribPointer(h,3,s.FLOAT,!1,c*3,0),s.enableVertexAttribArray(h),s.vertexAttribPointer(f,3,s.FLOAT,!1,c*3,0),s.enableVertexAttribArray(f),s.vertexAttrib4f(d,1,1,1,1),s.uniform1i(l,0),s.uniform1i(m,this.useLight?1:0);const u=s.getUniformLocation(s.program,"u_MvpMatrix"),E=s.getUniformLocation(s.program,"u_NormalMatrix"),y=s.getUniformLocation(s.program,"u_ModelMatrix");let b=H(A(),$(A(),this.absoluteModelMatrix));s.uniformMatrix4fv(E,!1,b),s.uniformMatrix4fv(y,!1,this.absoluteModelMatrix);let L=Z(this.absoluteModelMatrix,a,n);s.uniformMatrix4fv(u,!1,L),s.drawElements(s.TRIANGLES,36,s.UNSIGNED_BYTE,0),s.uniform1i(m,1),s.disableVertexAttribArray(f)}}class Re extends j{constructor(t,a=null){super(t,a);M(this,"vertextBuffer",null);M(this,"vertices",null);M(this,"lightPosition",R(-10,5,10));M(this,"lightCube");M(this,"loaded");this.modelMatrix=A(),this.children=[],this.modelMatrix=A(),this.absoluteModelMatrix=A(),this.lightCube=null,this.loaded=!1,Le().then(n=>{console.log(this),this.loaded=!0;const[i,s]=n,o=t.createBuffer();if(!o)throw console.error("Failed to create buffer"),new Error("Failed to create buffer");t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW),this.vertextBuffer=o,this.vertices=i;const h=t.getUniformLocation(t.program,"u_PositionalLight.position");t.uniform3fv(h,this.lightPosition);const d=t.getUniformLocation(t.program,"u_PositionalLight.color");t.uniform3f(d,1,1,1);const f=t.getUniformLocation(t.program,"u_PositionalLight.ambient");t.uniform4f(f,.2,.2,.2,1);const l=t.getUniformLocation(t.program,"u_PositionalLight.diffuse");t.uniform4f(l,1,1,1,1);const m=t.getUniformLocation(t.program,"u_PositionalLight.specular");t.uniform4f(m,1,1,1,1);const c=new ae(t,this,!1);c.modelMatrix=q(A(),c.modelMatrix,this.lightPosition),c.modelMatrix=ie(A(),R(.1,.1,.1)),this.lightCube=c,this.addChild(c)})}draw(t,a,n){if(!this.loaded)return;this.lightPosition=ye(T(),this.lightPosition,R(0,this.lightPosition[1],0),t),q(this.lightCube.modelMatrix,A(),this.lightPosition),pe(this.lightCube.modelMatrix,this.lightCube.modelMatrix,R(.1,.1,.1));const i=this.gl;super.draw(t,a,n);const s=i.getUniformLocation(i.program,"u_PositionalLight.position");i.uniform3fv(s,this.lightPosition),i.bindBuffer(i.ARRAY_BUFFER,this.vertextBuffer);const o=i.getUniformLocation(i.program,"u_Material.ambient");i.uniform4fv(o,k.ambient);const h=i.getUniformLocation(i.program,"u_Material.diffuse");i.uniform4fv(h,k.diffuse);const d=i.getUniformLocation(i.program,"u_Material.specular");i.uniform4fv(d,k.specular);const f=i.getUniformLocation(i.program,"u_Material.shininess");i.uniform1f(f,k.shininess);const l=this.vertices,m=i.getAttribLocation(i.program,"a_Position"),c=i.getAttribLocation(i.program,"a_Color"),u=i.getAttribLocation(i.program,"a_Normal"),E=l.BYTES_PER_ELEMENT;(m<0||c<0)&&console.error("Failed to get attribute location"),i.vertexAttrib4f(c,1,1,1,1),i.vertexAttribPointer(m,3,i.FLOAT,!1,6*E,0),i.enableVertexAttribArray(m),i.vertexAttribPointer(u,3,i.FLOAT,!1,6*E,3*E),i.enableVertexAttribArray(u);const y=i.getUniformLocation(i.program,"u_MvpMatrix");if(!y){console.error("Failed to get the storage location of u_MvpMatrix");return}const b=i.getUniformLocation(i.program,"u_LightColor"),L=i.getUniformLocation(i.program,"u_LightDirection"),_=i.getUniformLocation(i.program,"u_AmbientLight"),p=i.getUniformLocation(i.program,"u_NormalMatrix"),x=i.getUniformLocation(i.program,"u_ModelMatrix"),v=i.getUniformLocation(i.program,"u_UseTexture");i.uniform1i(v,0),i.uniform3f(b,1,1,1),i.uniform3fv(L,D(T(),[.5,3,4])),i.uniform3f(_,.2,.2,.2);let P=H(A(),$(A(),this.absoluteModelMatrix));i.uniformMatrix4fv(p,!1,P),i.uniformMatrix4fv(x,!1,this.absoluteModelMatrix);let U=Z(this.absoluteModelMatrix,a,n);i.uniformMatrix4fv(y,!1,U),i.drawArrays(i.TRIANGLES,0,5144*3),i.disableVertexAttribArray(u)}}class ge extends j{constructor(t,a=null){super(t,a);M(this,"vertexBuffer",null);M(this,"vertices",null);M(this,"elementBuffer",null);M(this,"texture",null);this.modelMatrix=A(),this.children=[],this.modelMatrix=A(),this.absoluteModelMatrix=A();let n=new Image;n.onload=()=>{this.texture=t.createTexture();const d=t.getUniformLocation(t.program,"u_Sampler");t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.texture),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,1),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGB,t.RGB,t.UNSIGNED_BYTE,n),t.uniform1i(d,0),console.log("load")},n.src="/brick.bmp";const i=new Float32Array([1,0,1,1,0,-1,0,1,0,0,-1,0,-1,0,1,1,0,-1,1,1]),s=new Uint8Array([0,1,2,0,2,3]),o=t.createBuffer(),h=t.createBuffer();if(!o)throw console.error("Failed to create buffer"),new Error("Failed to create buffer");t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,h),t.bufferData(t.ELEMENT_ARRAY_BUFFER,s,t.STATIC_DRAW),this.vertexBuffer=o,this.vertices=i,this.elementBuffer=h}draw(t,a,n){super.draw(t,a,n);const i=this.gl;i.activeTexture(i.TEXTURE0),i.bindBuffer(i.ARRAY_BUFFER,this.vertexBuffer),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.elementBuffer);const s=this.vertices,o=i.getAttribLocation(i.program,"a_Position"),h=i.getAttribLocation(i.program,"a_Color"),d=i.getAttribLocation(i.program,"a_Normal"),f=i.getAttribLocation(i.program,"a_TexCoord"),l=s.BYTES_PER_ELEMENT;(o<0||h<0)&&console.error("Failed to get attribute location"),i.vertexAttribPointer(o,3,i.FLOAT,!1,5*l,0),i.enableVertexAttribArray(o),i.vertexAttribPointer(f,2,i.FLOAT,!1,5*l,3*l),i.enableVertexAttribArray(f),i.vertexAttrib4f(h,1,1,1,1),i.vertexAttrib4f(d,0,1,0,0);const m=i.getUniformLocation(i.program,"u_MvpMatrix"),c=i.getUniformLocation(i.program,"u_NormalMatrix"),u=i.getUniformLocation(i.program,"u_ModelMatrix"),E=i.getUniformLocation(i.program,"u_UseTexture");i.uniform1i(E,1);let y=H(A(),$(A(),this.absoluteModelMatrix));i.uniformMatrix4fv(c,!1,y),i.uniformMatrix4fv(u,!1,this.absoluteModelMatrix);let b=Z(this.absoluteModelMatrix,a,n);i.uniformMatrix4fv(m,!1,b),i.drawElements(i.TRIANGLES,6,i.UNSIGNED_BYTE,0)}}class Pe{constructor(r,t,a){M(this,"gl");M(this,"viewMatrix");M(this,"modelMatrix");M(this,"projectionMatrix");M(this,"eye");M(this,"up");M(this,"pitch",0);M(this,"yaw",-Math.PI/2);M(this,"mouseX");M(this,"mouseY");M(this,"drag",!1);M(this,"currentKeyDown");M(this,"skybox");M(this,"skyboxProgram");M(this,"teapot");if(this.gl=r,r.enable(r.DEPTH_TEST),this.skybox=null,!we(r,t,a))throw new Error("Failed to initialize shaders");const n=r.program;this.skyboxProgram=r.program,r.program=n,r.useProgram(n),this.viewMatrix=A(),this.modelMatrix=A(),this.projectionMatrix=A(),this.eye=R(0,5,5),this.teapot=new Re(r);const i=new ae(r,this.teapot),s=new ge(r,this.teapot);i.modelMatrix=q(A(),A(),R(0,5,-10)),s.modelMatrix=ie(A(),R(20,20,20)),this.teapot.addChild(s),this.teapot.addChild(i),this.currentKeyDown={ArrowUp:!1,ArrowDown:!1,ArrowLeft:!1,ArrowRight:!1,w:!1,s:!1,a:!1,d:!1,q:!1,e:!1},this.viewMatrix=G(this.eye,this.pitch,this.yaw),this.up=R(0,1,0),Ae(this.projectionMatrix,Math.PI/2,1024/768,1,100)}draw(r){this.updateCamera(r);const t=this.gl;t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.teapot.draw(r,this.viewMatrix,this.projectionMatrix)}handleKeydown(r){r.key in this.currentKeyDown&&(this.currentKeyDown[r.key]=!0)}handleMousemove(r){if(!this.drag)return;if(!this.mouseX||!this.mouseY){this.mouseX=r.clientX,this.mouseY=r.clientY;return}const t=(r.clientX-this.mouseX)/-1e3,a=(r.clientY-this.mouseY)/1e3;this.pitch+=a*2,this.pitch=Math.max(Math.min(this.pitch,Math.PI/2-.01),-Math.PI/2+.01),this.yaw+=t*2,this.yaw=this.yaw%(Math.PI*2),this.viewMatrix=G(this.eye,this.pitch,this.yaw),this.mouseX=r.clientX,this.mouseY=r.clientY}handleMouseup(r){this.mouseX=void 0,this.mouseY=void 0,this.drag=!1}handleMousedown(r){this.drag=!0}handleKeyup(r){r.key in this.currentKeyDown&&(this.currentKeyDown[r.key]=!1)}updateCamera(r){const t=Te(this.pitch,this.yaw);if(this.currentKeyDown.ArrowUp)this.pitch+=r,this.pitch=Math.max(Math.min(this.pitch,Math.PI/2-.01),-Math.PI/2+.01);else if(this.currentKeyDown.ArrowDown)this.pitch-=r,this.pitch=Math.max(Math.min(this.pitch,Math.PI/2-.01),-Math.PI/2+.01);else if(this.currentKeyDown.ArrowLeft)this.yaw-=r,this.yaw=this.yaw%(Math.PI*2);else if(this.currentKeyDown.ArrowRight)this.yaw+=r,this.yaw=this.yaw%(Math.PI*2);else if(this.currentKeyDown.w)F(this.eye,this.eye,B(T(),D(T(),R(t[0],0,t[2])),r*4));else if(this.currentKeyDown.s)F(this.eye,this.eye,B(T(),D(T(),R(t[0],0,t[2])),-r*4));else if(this.currentKeyDown.a){const a=D(T(),re(T(),t,this.up));F(this.eye,this.eye,B(T(),a,-r*4))}else if(this.currentKeyDown.d){const a=D(T(),re(T(),t,this.up));F(this.eye,this.eye,B(T(),a,r*4))}else this.currentKeyDown.q?F(this.eye,this.eye,B(T(),this.up,-r*4)):this.currentKeyDown.e&&F(this.eye,this.eye,B(T(),this.up,r*4));this.viewMatrix=G(this.eye,this.pitch,this.yaw)}}const Ue={class:"h-screen relative"},Fe={class:"flex h-full"},Be={class:"relative m-auto"},Ye=oe({__name:"graphic",setup(e){const r=z(null),t=z(null);let a=0,n=null,i=null,s=null,o=null;const h=z(!1);function d(){const f=performance.now()/1e3,l=f-a;a=f,o.fillStyle="white",o.clearRect(0,0,400,100),o.font="50px serif",o.fillText(`FPS: ${Math.round(1/l)}`,50,90),s.draw(l),n=requestAnimationFrame(d)}return le(async()=>{i=r.value.getContext("webgl"),o=t.value.getContext("2d");const{default:f}=await W(()=>import("./vshader.f049359e.js"),[],import.meta.url),{default:l}=await W(()=>import("./fshader.4320ede6.js"),[],import.meta.url);s=new Pe(i,f,l),a=performance.now()/1e3,h.value=!0,d()}),he(()=>{n&&cancelAnimationFrame(n)}),(f,l)=>{const m=de,c=Me;return ce(),fe("div",Ue,[J(m,null,{default:Q(()=>[ee("WebGL")]),_:1}),J(c,{to:"/",class:"absolute top-4 left-4 z-10 px-3 py-1 bg-cyan-400 rounded-full hover:bg-cyan-600 text-white"},{default:Q(()=>[ee(" Home")]),_:1}),X("div",Fe,[me(X("div",Be,[X("canvas",{tabindex:"0",class:"outline-none relative z-0 top-0 left-0",ref_key:"c",ref:r,width:"1024",height:"768",onKeydownCapture:l[0]||(l[0]=(...u)=>g(s).handleKeydown&&g(s).handleKeydown(...u)),onMousemoveCapture:l[1]||(l[1]=(...u)=>g(s).handleMousemove&&g(s).handleMousemove(...u)),onMousedown:l[2]||(l[2]=(...u)=>g(s).handleMousedown&&g(s).handleMousedown(...u)),onMouseup:l[3]||(l[3]=(...u)=>g(s).handleMouseup&&g(s).handleMouseup(...u)),onKeyupCapture:l[4]||(l[4]=(...u)=>g(s).handleKeyup&&g(s).handleKeyup(...u))},null,544),X("canvas",{class:"absolute z-10 top-0 left-0",width:"400",height:"100",ref_key:"hud",ref:t},null,512)],512),[[ue,h.value]])])])}}});export{Ye as default};
